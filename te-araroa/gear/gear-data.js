var TLP_GEAR_LIST = function () {
    var data = {
        "categories": [
            {
                "name": "Pack",
                "items": [
                    {
                        "name": "Pack",
                        "desc": "Aarns Designs FeatherLite Freedom Bodypack",
                        "comment": "67 litres, built in waterproof liner",
                        "quantity": 1,
                        "weight": 1854
                    }
                ]
            },
            {
                "name": "Clothing",
                "items": [
                    {
                        "name": "Shorts",
                        "desc": "Earth Sea Sky Taslan",
                        "comment": "Comfortable, hard-wearing",
                        "quantity": 2,
                        "quantityWorn": 1,
                        "weight": 145
                    },
                    {
                        "name": "Base layer",
                        "desc": "Icebreaker GT t-shirt, 150gm merino",
                        "comment": "Warm, non-chafing seams",
                        "quantity": 2,
                        "quantityWorn": 1,
                        "weight": 142
                    },
                    {
                        "name": "Rain jacket",
                        "desc": "ZPacks Cuben Fibre eVent with pit zips",
                        "quantity": 1,
                        "weight": 138
                    },
                    {
                        "name": "Trail runners",
                        "desc": "Saucony Exodus 3.0",
                        "comment": "Tramping footware for the past 9 months. Comfortable, hard-wearing",
                        "quantity": 1,
                        "quantityWorn": 1,
                        "weight": 711
                    },
                    {
                        "name": "Gaiters",
                        "desc": "Simblissity LevaGaiter, large",
                        "comment": "Strapless, specifically designed for trail runners",
                        "quantity": 1,
                        "quantityWorn": 1,
                        "weight": 52
                    },
                    {
                        "name": "Socks",
                        "desc": "Icebreaker Multisport Mini",
                        "quantity": 3,
                        "quantityWorn": 1,
                        "weight": 67
                    },
                    {
                        "name": "Underwear",
                        "desc": "Arc''teryx Phase SL Boxer",
                        "quantity": 3,
                        "quantityWorn": 1,
                        "weight": 55
                    },
                    {
                        "name": "Wind Jacket",
                        "desc": "Patagonia Houdini",
                        "quantity": 1,
                        "weight": 121
                    },
                    {
                        "name": "Insulating Layer",
                        "desc": "Mountain Hardwear Ghost Whisperer Down Jacket",
                        "comment": "Medium, hoodless",
                        "quantity": 1,
                        "weight": 192
                    },
                    {
                        "name": "Rain Kilt",
                        "desc": "ZPacks CloudKilt",
                        "quantity": 1,
                        "weight": 54
                    }
                ]
            },
            {
                "name": "Cooking / Hydration",
                "items": [
                    {
                        "name": "Cooking pot",
                        "desc": ".9L Amp Titanium Solo",
                        "comment": "Perfect size for a one person meal cooked in boiling water. Doubles as a mug",
                        "quantity": 1,
                        "weight": 128
                    },
                    {
                        "name": "Spork",
                        "desc": "Sea to summit",
                        "quantity": 1,
                        "weight": 7
                    },
                    {
                        "name": "Gas lighter",
                        "desc": "Standard size Bic",
                        "quantity": 2,
                        "weight": 25
                    },
                    {
                        "name": "Stove",
                        "desc": "MSR Pocket Rocket",
                        "comment": "Includes hard-shell case",
                        "quantity": 1,
                        "weight": 119
                    },
                    {
                        "name": "Fuel",
                        "desc": "230g butane/propane canister",
                        "comment": "~90 mins cooking time",
                        "quantity": 1,
                        "weight": 230
                    },
                    {
                        "name": "Water Bottle",
                        "desc": "Platypus  plusBottle 1L",
                        "comment": "Multiple 1L for redundancy",
                        "quantity": 3,
                        "weight": 38
                    },
                    {
                        "name": "Water Treatment",
                        "desc": "Aquamira Drops",
                        "comment": "Chlorine dioxide. Effective against protozoa, bacteria and viruses",
                        "quantity": 1,
                        "weight": 88
                    },
                    {
                        "name": "Water Filter",
                        "desc": "Sawyer Squeeze",
                        "comment": "0.1 microns filter. Effective against protozoa, bacteria and particulate",
                        "quantity": 1,
                        "weight": 98
                    }
                ]
            },
            {
                "name": "Sleep / Shelter",
                "items": [
                    {
                        "name": "Tent",
                        "desc": "Tarptent Notch",
                        "quantity": 1,
                        "weight": 700
                    },
                    {
                        "name": "Tent poles",
                        "desc": "Black Diamond Distance FL trekking poles, 105-125 cm",
                        "quantity": 1,
                        "quantityWorn": 1,
                        "weight": 455
                    },
                    {
                        "name": "Sleeping mat",
                        "desc": "Therm-a-Rest NeoAir XLite",
                        "quantity": 1,
                        "weight": 350
                    },
                    {
                        "name": "Sleeping bag",
                        "desc": "30 Degree ZPacks bag",
                        "comment": "Regular width, medium Length, icludes cuben fibre stuff sack",
                        "quantity": 1,
                        "weight": 422
                    },
                    {
                        "name": "Silk liner",
                        "quantity": 1,
                        "weight": 117
                    },
                    {
                        "name": "Pillow",
                        "desc": "ZPacks Pillow",
                        "comment": "Medium dry bag with micro fleece inside",
                        "quantity": 1,
                        "weight": 47
                    },
                    {
                        "name": "Headlamp",
                        "desc": "Petzl Tikka",
                        "comment": "Excluding batteries",
                        "quantity": 1,
                        "weight": 43
                    },
                    {
                        "name": "Headlamp batteries",
                        "desc": "AAA",
                        "comment": "Includes spares",
                        "quantity": 6,
                        "weight": 12
                    }
                ]
            },
            {
                "name": "Health / Hygiene",
                "items": [
                    {
                        "name": "Insect repellent",
                        "desc": "Natural Goodbye Sandfly, 40ml",
                        "quantity": 1,
                        "weight": 47
                    },
                    {
                        "name": "Anti-histamine",
                        "desc": "30 Loratadine tablets",
                        "comment": "Wasp/bee stings",
                        "quantity": 1,
                        "weight": 6
                    },
                    {
                        "name": "Pain relief",
                        "desc": "12 Ibuprofen tablets",
                        "quantity": 1,
                        "weight": 7
                    },
                    {
                        "name": "Bandage",
                        "desc": "Roll of 1 inch cotton gauze",
                        "quantity": 1,
                        "weight": 6
                    },
                    {
                        "name": "Kinesiology tape",
                        "desc": "Rock Tape, 5cm x 5m",
                        "comment": "Doesn''t come in roles less than 5m. Also used as a sticking plaster",
                        "quantity": 1,
                        "weight": 87
                    },
                    {
                        "name": "Suture",
                        "desc": "Super glue, 3ml",
                        "quantity": 1,
                        "weight": 5
                    },
                    {
                        "name": "Anti-chafe balm",
                        "desc": "Body Glide stick",
                        "quantity": 1,
                        "weight": 74
                    },
                    {
                        "name": "Antiseptic",
                        "desc": "Tincture of Benzoin, 50ml",
                        "comment": "Also used for blister treatment before applying kinesio tape",
                        "quantity": 1,
                        "weight": 55
                    },
                    {
                        "name": "Travel towel",
                        "desc": "Medium size",
                        "quantity": 1,
                        "weight": 53
                    },
                    {
                        "name": "Hand sanitiser",
                        "desc": "Sea to Summit",
                        "comment": "Repackaged to reduce weight",
                        "quantity": 1,
                        "weight": 71
                    },
                    {
                        "name": "Toothbrush",
                        "quantity": 1,
                        "weight": 16
                    },
                    {
                        "name": "Toothpaste",
                        "quantity": 1,
                        "weight": 0
                    }
                ]
            },
            {
                "name": "Safety / Navigation",
                "items": [
                    {
                        "name": "Locator beacon",
                        "desc": "GME AccuSat MT41",
                        "comment": "Includes protective case",
                        "quantity": 1,
                        "weight": 268
                    },
                    {
                        "name": "Whistle",
                        "quantity": 1,
                        "weight": 6
                    },
                    {
                        "name": "Compass",
                        "desc": "Suunto M3-G",
                        "quantity": 1,
                        "weight": 44
                    }
                ]
            },
            {
                "name": "Photography",
                "items": [
                    {
                        "name": "Camera body",
                        "desc": "Canon 5D MkII",
                        "comment": "",
                        "quantity": 1,
                        "weight": 810
                    },
                    {
                        "name": "Lens",
                        "desc": "Canon EF 24mm f/2.8 IS USM",
                        "comment": "",
                        "quantity": 1,
                        "weight": 280
                    },
                    {
                        "name": "Compact Flash",
                        "desc": "SanDisk Extreme 32GB 60 MB/s UDMA",
                        "quantity": 3,
                        "weight": 9
                    },
                    {
                        "name": "Battery",
                        "desc": "LP-E6",
                        "quantity": 3,
                        "weight": 77
                    },
                    {
                        "name": "Battery charger",
                        "desc": "SterlingTEK DZ14",
                        "quantity": 1,
                        "weight": 100
                    },
                    {
                        "name": "Camera bag",
                        "desc": "Lowpro Toploader Zoom 45 AW",
                        "quantity": 1,
                        "weight": 192
                    }
                ]
            },
            {
                "name": "Miscellaneous",
                "items": [
                    {
                        "name": "Android phone",
                        "desc": "Bubble wrap case",
                        "quantity": 1,
                        "weight": 117
                    },
                    {
                        "name": "Reading glasses",
                        "desc": "Bubble wrap case",
                        "quantity": 1,
                        "weight": 27
                    },
                    {
                        "name": "Mains USB charger",
                        "quantity": 1,
                        "weight": 31
                    },
                    {
                        "name": "Phone USB cable",
                        "quantity": 1,
                        "weight": 14
                    }
                ]
            }
        ]
    };

    /**
     * Sorts the specified items by item weight (descending)
     *
     * @param {Array} items
     * @returns {Array} the sorted items
     */
    var sortItemsByItemWeight = function (items) {
        return _.sortBy(items, function (item) {
            return -item.weight;
        });
    };

    /**
     * Sorts the specified items by pack weight (descending)
     *
     * @param {Array} items
     * @returns {Array}
     */
    var sortItemsByPackWeight = function (items) {
        return _.sortBy(items, function (item) {
            return -getItemWeights(item).packWeight;
        });
    };

    /**
     * Calculates the total weight and pack weight for the specified item
     *
     * @param {Object} item
     * @returns {{totalWeight: number, packWeight: number}}
     */
    var getItemWeights = function (item) {
        var totalWeight = item.weight * item.quantity;
        var packWeight = item.weight * getItemPackQuantity(item);
        return {
            totalWeight: totalWeight,
            packWeight: packWeight
        };
    };

    /**
     * Calculates the total weight and pack weight for the items in specified category
     *
     * @param {Object} category
     * @returns {{totalWeight: number, packWeight: number}}
     */
    var getCategoryWeights = function (category) {
        var totalWeight = 0;
        var packWeight = 0;
        _.each(category.items, function (item) {
            var itemWeights = getItemWeights(item);
            totalWeight += itemWeights.totalWeight;
            packWeight += itemWeights.packWeight;
        });
        return {
            totalWeight: totalWeight,
            packWeight: packWeight
        };
    };

    /**
     * Calculates the quantity of the specified item carried in the pack, i.e. total quantity - quantity worn
     *
     * @param {Object} item
     * @returns {Number} the quantity of the specified item carried in the pack
     */
    function getItemPackQuantity(item) {
        return item.quantityWorn ? item.quantity - item.quantityWorn : item.quantity;
    }

    return {
        data: data,
        sortItemsByItemWeight: sortItemsByItemWeight,
        sortItemsByPackWeight: sortItemsByPackWeight,
        getItemWeights: getItemWeights,
        getCategoryWeights: getCategoryWeights
    };
}();